# 🚀 Wallet Analysis System: Project Roadmap

## ✨ Immediate Focus

### 🎯 High Priority
*   ✅ **Analysis Triggering API & Frontend Integration (Simplified Initial Version)**
    *   Backend API endpoint (`POST /api/v1/analyses/wallets/:walletAddress/trigger-analysis`) implemented.
    *   Frontend integration in `WalletProfileLayout.tsx` with trigger button, feedback, and SWR cache revalidation.
*   ✅ **Basic Sidebar Wallet Navigation (Search & Recent List)**
    *   Goal: Improve wallet discovery and navigation.
    *   Backend: Implement `/search` and `/recent` wallet API endpoints.
    *   Frontend: Add sidebar search and recent wallets list.
*   🚧 **Consistent Loading, Empty, and Error States Across Dashboard**
    *   Goal: Ensure professional and consistent UX.
    *   Tasks: Document design principles and implement across all tabs/components.

### ⏳ Medium Priority
*   🚧 **Basic "Wallet Comparison" / "Find Similar Wallets" Feature (Pilot)**
    *   Goal: Initial functionality for wallet comparison.
    *   Backend: Refactor `walletSimilarity.ts` into `SimilarityService`, expose via API.
    *   Frontend: Simple UI to trigger and display similar wallets.
*   🤔 **AI Insights for Overview Tab (Conceptual Planning)**
    *   Goal: Plan AI-driven summary for the Overview tab.
    *   Tasks: Brainstorm insights, sketch UI layouts (no immediate implementation).

### 😴 Lower Priority (Defer for Now)
*   Full Sidebar Enhancements (user-savable lists, full Settings/Docs pages).
*   Advanced Chart Aesthetic Refinements.
*   Specific Typography Details.

---

## Phase 1: Core Analysis Logic Extraction ✅
*   ✅ **1.1 Reorganize Existing Types**
*   ✅ **1.2 Extract Core Analysis Logic**
    *   ✅ 1.2.1 Correlation Analysis (`CorrelationAnalyzer`)
    *   ✅ 1.2.2 Behavior Analysis (`BehaviorAnalyzer`)
    *   ✅ 1.2.3 Similarity Analysis (`SimilarityAnalyzer`)
    *   ✅ 1.2.4 KPI Reporting Analysis (`KPIComparisonAnalyzer`)
*   ✅ **1.3 Extract Utility Functions**
    *   ✅ 1.3.1 PNL Calculation (`pnl_calculator.ts`)
    *   ✅ 1.3.2 Reporting Utilities (`report_utils.ts`)

---

## Phase 2: Service Layer Enhancement 🟢 (Largely Complete)
*   🟢 **2.1 Analysis Services**
    *   🟢 `CorrelationService`
    *   🟢 `BehaviorService`
    *   🟢 `SimilarityService`
    *   🟢 `ReportingService`
*   ✅ **2.2 Enhance Existing Services**
    *   ✅ `DatabaseService` (Refactored, Verified)
    *   ✅ `HeliusApiClient` (Verified)
    *   ✅ `HeliusTransactionMapper` (Verified)

---

## Phase 3: Script Refactoring 🟢 (Largely Complete)
*Goal: Transform scripts into simple orchestrators.*
*   ✅ **3.1 `activityCorrelator.ts`**
*   ✅ **3.2 `wallet-behavior-analyzer.ts`**
*   ✅ **3.3 `kpi-comparison-report.ts`**
*   🚧 **3.4 `walletSimilarity.ts`** (Status: To Do - Update `main` function)
*   ✅ **3.5 `helius-analyzer.ts`** (Refactored with refined analysis trigger logic)

---

## Phase 4: API Layer Implementation ✅
*Goal: Develop a robust API layer for client applications.*
*   ✅ **4.1 API Design Principles & Technology** (RESTful, Stateless, Versioned, NestJS recommended)
*   ✅ **4.2 Core API Components & User Tracking**
    *   ✅ 4.2.1 Database Schema for User Tracking (`User`, `ActivityLog` models)
    *   ✅ 4.2.2 Authentication (X-API-Key header)
    *   ✅ 4.2.3 `DatabaseService` Enhancements (User/API key management, ActivityLog recording)
*   ✅ **4.3 API Endpoints**
    *   ✅ `GET /wallets/{walletAddress}/summary` (Implemented)
    *   ✅ `GET /wallets/{walletAddress}/token-performance` (Implemented)
    *   ✅ `GET /wallets/{walletAddress}/pnl-overview` (Implemented)
    *   ✅ `GET /wallets/{walletAddress}/behavior-analysis` (Implemented)
    *   ✅ `/wallets/{walletAddress}/aggregated-metrics` (Consolidated into `/summary`)
    *   ✅ `POST /analyses/wallets/{walletAddress}/trigger-analysis` (Future - for dashboard control, part of unified trigger pattern)
    *   ⏳ `GET /analyses/jobs/{jobId}/status` (Future - for polling job status)
*   ✅ **4.4 Service Layer Interaction** (Controllers validate, auth, log, call services)
*   ✅ **4.5 Pre-computation vs. On-the-fly API Calculation** (Primarily serve pre-calculated data)
*   ✅ **4.6 Relationship with Existing Scripts** (Coexistence, API for on-demand)

---

## Phase 5: Dashboard Integration 🟢 (Largely Complete - Focus on UX Polish & Open Design Questions)
*Goal: Develop an intuitive web-based dashboard consuming the API.*
*   ✅ **5.1 Dashboard Technology Stack & Architecture**
    *   Framework: Next.js (App Router)
    *   Styling: TailwindCSS
    *   Components: shadcn/ui, Tremor
    *   Charting: Apache ECharts (`EChartComponent.tsx` created)
    *   Data Fetching: SWR/React Query
    *   State Management: Zustand/React Context
*   ✅ **5.2 Dashboard Structure and API Mapping**
    *   ✅ Sidebar (Collapsible, shadcn/ui, tooltips, settings/help in footer)
    *   ✅ Main Window - Top Section (Sticky Summary Bar, collapsible, `AccountSummaryCard.tsx` refined)
    *   🟢 Universal Time Filter (Functionality largely complete, minor UI polish ongoing)
    *   ✅ Main Window - Bottom Section (Tabbed Data Views - `WalletTabsContainer` with slimmer tab bar)
        *   ✅ Tab 1: Token Performance
        *   ✅ Tab 2: Account Stats & PNL
        *   ✅ Tab 3: Behavioral Patterns
        *   ✅ Tab 4: Reviewer Log / Notes
*   ✅ **5.3 Development Plan & Execution Steps (4-Week Cycle Example)**
    *   ✅ **Week 1: Project Setup & Layout Skeleton**
    *   ✅ **Week 2: Time Filter, Sticky Summary & "Token Performance" Tab**
    *   ✅ **Week 3: "Account Stats & PNL" and "Behavioral Patterns" Tabs**
    *   ✅ **Week 4: "Reviewer Log/Notes" Tab, Polish & Export** (Export optional, UX Polish partially complete/ongoing)
*   ⏳ **5.4 Future Enhancements (Post-Initial Build)**
    *   Wallet Comparison View
    *   Leaderboards/Segment Comparison
    *   Advanced Chart Interactions
    *   User-Savable Views/Filters
    *   Integration with AI Assistant (Phase 6)
*   🚧 **5.5 Relationship with Existing Scripts & API**
    *   Dashboard consumes API layer.

---

## Phase 6: AI Assistant Integration 💡 (Experimental Pilot)
*Goal: Explore LLM-based AI assistant for natural language querying and summaries.*
*   Prerequisites: Stable API, defined data models, initial dashboard.
*   Approach: Tool-based LLM interaction (API as primary tool source), read-only initially.
*   🚧 **Tasks:**
    *   Define initial scope & use cases.
    *   Design LLM tools based on existing API endpoints.
    *   Develop and test a pilot integration.

---

## Phase 7: Performance & Asynchronous Operations ⏳ (Future Enhancement)
*Goal: Offload long-running tasks to background workers for non-blocking API.*
*   ⏳ **7.1 Job Queue System Introduction** (e.g., BullMQ + Redis)
*   ⏳ **7.2 API Integration with Job Queue**
*   ⏳ **7.3 Worker Services Implementation**

---

## Phase 8: Advanced Database Scalability & Optimization ⏳ (Future Enhancement)
*Goal: Handle larger datasets and higher transaction volumes if SQLite limits are hit.*
*   ⏳ **8.1 Database Migration to PostgreSQL**
*   ⏳ **8.2 Advanced Caching Layer** (Redis)
*   ⏳ **8.3 Analytical Acceleration** (DuckDB, Data Warehouse if needed for very large scale)

---

## 📋 Implementation Order (Summary)
1.  ✅ Type Consolidation
2.  ✅ Core Analysis Extraction
3.  ✅ Utility Function Extraction
4.  🟢 Service Implementation (Largely Done, user context refinement ongoing)
5.  ✅ Configuration Type Refactoring
6.  🟢 Script Transformation (`walletSimilarity.ts` is To Do)
7.  ✅ **Phase 4: API Layer Implementation**
8.  🟢 **Phase 5: Dashboard Integration** (Largely Complete, UX Polish & Open Questions ongoing)
9.  🚧 **Testing** (Ongoing, define Helius Mapper test)
10. 💡 **Phase 6: AI Assistant Integration** (Experimental Pilot - New)
11. ⏳ **Phase 7: Performance & Asynchronous Operations** (Future Enhancement)
12. ⏳ **Phase 8: Advanced Database Scalability & Optimization** (Future Enhancement)
13. ⏳ (Further Future API Layer for Admin/Advanced Features)

---
Key:
✅ - Complete
🟢 - Largely Complete / In Progress / Ongoing
🚧 - To Do / Next Up
⏳ - Future Enhancement / Deferred
🤔 - Conceptual Planning
💡 - Experimental / Pilot
