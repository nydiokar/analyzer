# ğŸš€ Wallet Analysis System: Project Roadmap

## âœ¨ Immediate Focus

### ğŸ¯ High Priority
*   âœ… **Analysis Triggering API & Frontend Integration (Simplified Initial Version)**
    *   Backend API endpoint (`POST /api/v1/analyses/wallets/:walletAddress/trigger-analysis`) implemented.
    *   Frontend integration in `WalletProfileLayout.tsx` with trigger button, feedback, and SWR cache revalidation.
*   âœ… **Basic Sidebar Wallet Navigation (Search & Recent List)**
    *   Goal: Improve wallet discovery and navigation.
    *   Backend: Implement `/search` and `/recent` wallet API endpoints.
    *   Frontend: Add sidebar search and recent wallets list.
*   ğŸš§ **Consistent Loading, Empty, and Error States Across Dashboard**
    *   Goal: Ensure professional and consistent UX.
    *   Tasks: Document design principles and implement across all tabs/components.

### â³ Medium Priority
*   ğŸš§ **Basic "Wallet Comparison" / "Find Similar Wallets" Feature (Pilot)**
    *   Goal: Initial functionality for wallet comparison.
    *   Backend: Refactor `walletSimilarity.ts` into `SimilarityService`, expose via API.
    *   Frontend: Simple UI to trigger and display similar wallets.
*   ğŸ¤” **AI Insights for Overview Tab (Conceptual Planning)**
    *   Goal: Plan AI-driven summary for the Overview tab.
    *   Tasks: Brainstorm insights, sketch UI layouts (no immediate implementation).

### ğŸ˜´ Lower Priority (Defer for Now)
*   Full Sidebar Enhancements (user-savable lists, full Settings/Docs pages).
*   Advanced Chart Aesthetic Refinements.
*   Specific Typography Details.

---

## Phase 1: Core Analysis Logic Extraction âœ…
*   âœ… **1.1 Reorganize Existing Types**
*   âœ… **1.2 Extract Core Analysis Logic**
    *   âœ… 1.2.1 Correlation Analysis (`CorrelationAnalyzer`)
    *   âœ… 1.2.2 Behavior Analysis (`BehaviorAnalyzer`)
    *   âœ… 1.2.3 Similarity Analysis (`SimilarityAnalyzer`)
    *   âœ… 1.2.4 KPI Reporting Analysis (`KPIComparisonAnalyzer`)
*   âœ… **1.3 Extract Utility Functions**
    *   âœ… 1.3.1 PNL Calculation (`pnl_calculator.ts`)
    *   âœ… 1.3.2 Reporting Utilities (`report_utils.ts`)

---

## Phase 2: Service Layer Enhancement ğŸŸ¢ (Largely Complete)
*   ğŸŸ¢ **2.1 Analysis Services**
    *   ğŸŸ¢ `CorrelationService`
    *   ğŸŸ¢ `BehaviorService`
    *   ğŸŸ¢ `SimilarityService`
    *   ğŸŸ¢ `ReportingService`
*   âœ… **2.2 Enhance Existing Services**
    *   âœ… `DatabaseService` (Refactored, Verified)
    *   âœ… `HeliusApiClient` (Verified)
    *   âœ… `HeliusTransactionMapper` (Verified)

---

## Phase 3: Script Refactoring ğŸŸ¢ (Largely Complete)
*Goal: Transform scripts into simple orchestrators.*
*   âœ… **3.1 `activityCorrelator.ts`**
*   âœ… **3.2 `wallet-behavior-analyzer.ts`**
*   âœ… **3.3 `kpi-comparison-report.ts`**
*   ğŸš§ **3.4 `walletSimilarity.ts`** (Status: To Do - Update `main` function)
*   âœ… **3.5 `helius-analyzer.ts`** (Refactored with refined analysis trigger logic)

---

## Phase 4: API Layer Implementation âœ…
*Goal: Develop a robust API layer for client applications.*
*   âœ… **4.1 API Design Principles & Technology** (RESTful, Stateless, Versioned, NestJS recommended)
*   âœ… **4.2 Core API Components & User Tracking**
    *   âœ… 4.2.1 Database Schema for User Tracking (`User`, `ActivityLog` models)
    *   âœ… 4.2.2 Authentication (X-API-Key header)
    *   âœ… 4.2.3 `DatabaseService` Enhancements (User/API key management, ActivityLog recording)
*   âœ… **4.3 API Endpoints**
    *   âœ… `GET /wallets/{walletAddress}/summary` (Implemented)
    *   âœ… `GET /wallets/{walletAddress}/token-performance` (Implemented)
    *   âœ… `GET /wallets/{walletAddress}/pnl-overview` (Implemented)
    *   âœ… `GET /wallets/{walletAddress}/behavior-analysis` (Implemented)
    *   âœ… `/wallets/{walletAddress}/aggregated-metrics` (Consolidated into `/summary`)
    *   âœ… `POST /analyses/wallets/{walletAddress}/trigger-analysis` (Future - for dashboard control, part of unified trigger pattern)
    *   â³ `GET /analyses/jobs/{jobId}/status` (Future - for polling job status)
*   âœ… **4.4 Service Layer Interaction** (Controllers validate, auth, log, call services)
*   âœ… **4.5 Pre-computation vs. On-the-fly API Calculation** (Primarily serve pre-calculated data)
*   âœ… **4.6 Relationship with Existing Scripts** (Coexistence, API for on-demand)

---

## Phase 5: Dashboard Integration ğŸŸ¢ (Largely Complete - Focus on UX Polish & Open Design Questions)
*Goal: Develop an intuitive web-based dashboard consuming the API.*
*   âœ… **5.1 Dashboard Technology Stack & Architecture**
    *   Framework: Next.js (App Router)
    *   Styling: TailwindCSS
    *   Components: shadcn/ui, Tremor
    *   Charting: Apache ECharts (`EChartComponent.tsx` created)
    *   Data Fetching: SWR/React Query
    *   State Management: Zustand/React Context
*   âœ… **5.2 Dashboard Structure and API Mapping**
    *   âœ… Sidebar (Collapsible, shadcn/ui, tooltips, settings/help in footer)
    *   âœ… Main Window - Top Section (Sticky Summary Bar, collapsible, `AccountSummaryCard.tsx` refined)
    *   ğŸŸ¢ Universal Time Filter (Functionality largely complete, minor UI polish ongoing)
    *   âœ… Main Window - Bottom Section (Tabbed Data Views - `WalletTabsContainer` with slimmer tab bar)
        *   âœ… Tab 1: Token Performance
        *   âœ… Tab 2: Account Stats & PNL
        *   âœ… Tab 3: Behavioral Patterns
        *   âœ… Tab 4: Reviewer Log / Notes
*   âœ… **5.3 Development Plan & Execution Steps (4-Week Cycle Example)**
    *   âœ… **Week 1: Project Setup & Layout Skeleton**
    *   âœ… **Week 2: Time Filter, Sticky Summary & "Token Performance" Tab**
    *   âœ… **Week 3: "Account Stats & PNL" and "Behavioral Patterns" Tabs**
    *   âœ… **Week 4: "Reviewer Log/Notes" Tab, Polish & Export** (Export optional, UX Polish partially complete/ongoing)
*   â³ **5.4 Future Enhancements (Post-Initial Build)**
    *   Wallet Comparison View
    *   Leaderboards/Segment Comparison
    *   Advanced Chart Interactions
    *   User-Savable Views/Filters
    *   Integration with AI Assistant (Phase 6)
*   ğŸš§ **5.5 Relationship with Existing Scripts & API**
    *   Dashboard consumes API layer.

---

## Phase 6: AI Assistant Integration ğŸ’¡ (Experimental Pilot)
*Goal: Explore LLM-based AI assistant for natural language querying and summaries.*
*   Prerequisites: Stable API, defined data models, initial dashboard.
*   Approach: Tool-based LLM interaction (API as primary tool source), read-only initially.
*   ğŸš§ **Tasks:**
    *   Define initial scope & use cases.
    *   Design LLM tools based on existing API endpoints.
    *   Develop and test a pilot integration.

---

## Phase 7: Performance & Asynchronous Operations â³ (Future Enhancement)
*Goal: Offload long-running tasks to background workers for non-blocking API.*
*   â³ **7.1 Job Queue System Introduction** (e.g., BullMQ + Redis)
*   â³ **7.2 API Integration with Job Queue**
*   â³ **7.3 Worker Services Implementation**

---

## Phase 8: Advanced Database Scalability & Optimization â³ (Future Enhancement)
*Goal: Handle larger datasets and higher transaction volumes if SQLite limits are hit.*
*   â³ **8.1 Database Migration to PostgreSQL**
*   â³ **8.2 Advanced Caching Layer** (Redis)
*   â³ **8.3 Analytical Acceleration** (DuckDB, Data Warehouse if needed for very large scale)

---

## ğŸ“‹ Implementation Order (Summary)
1.  âœ… Type Consolidation
2.  âœ… Core Analysis Extraction
3.  âœ… Utility Function Extraction
4.  ğŸŸ¢ Service Implementation (Largely Done, user context refinement ongoing)
5.  âœ… Configuration Type Refactoring
6.  ğŸŸ¢ Script Transformation (`walletSimilarity.ts` is To Do)
7.  âœ… **Phase 4: API Layer Implementation**
8.  ğŸŸ¢ **Phase 5: Dashboard Integration** (Largely Complete, UX Polish & Open Questions ongoing)
9.  ğŸš§ **Testing** (Ongoing, define Helius Mapper test)
10. ğŸ’¡ **Phase 6: AI Assistant Integration** (Experimental Pilot - New)
11. â³ **Phase 7: Performance & Asynchronous Operations** (Future Enhancement)
12. â³ **Phase 8: Advanced Database Scalability & Optimization** (Future Enhancement)
13. â³ (Further Future API Layer for Admin/Advanced Features)

---
Key:
âœ… - Complete
ğŸŸ¢ - Largely Complete / In Progress / Ongoing
ğŸš§ - To Do / Next Up
â³ - Future Enhancement / Deferred
ğŸ¤” - Conceptual Planning
ğŸ’¡ - Experimental / Pilot
